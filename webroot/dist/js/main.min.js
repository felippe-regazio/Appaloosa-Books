!function(){function e(e,t){var a="../img/bg/",o="";t?(o="linear-gradient( rgba(0,0,0,.6), rgba(0,0,0,.6), rgba(0,0,0,.6)),",a+=$(e).attr("data-bg-overlay")):(o="",a+=$(e).attr("data-bg")),$(e).css({background:o+'url("'+a+'") no-repeat center center',"background-size":"cover"})}function t(e,s){e.each(function(){var e=$(this).attr("data-spotlight"),t=$(window).width(),a=$(window).height(),o=50;y=50,s&&(o=Math.round(s.pageX/t*100),y=Math.round(s.pageY/a*100)),$(this).css({background:"linear-gradient( rgba(0,0,0,.6), rgba(0,0,0,.6), rgba(0,0,0,.6)),radial-gradient( circle 500px at "+o+"% "+y+"%, rgba(55,55,55,.3), rgba(0,0,0,.9)), url(../img/bg/"+e+") no-repeat center center","background-size":"cover"})})}if("undefined"!=typeof AOS&&AOS.init(),$("[data-bg-overlay]").each(function(){e(this,!0)}),$("[data-bg]").each(function(){e(this,!1)}),$("[data-doodle]").each(function(){var e="../img/doodle/"+$(this).attr("data-doodle");$(this).css("background",'url("'+e+'") no-repeat center center')}),isSafari=!!navigator.userAgent.match(/Version\/[\d\.]+.*Safari/),0<$(".spotlight").length&&($(".spotlight").each(function(){t($(this),!1)}),isSafari||$(".spotlight").mousemove(function(e){t($(this),e)})),$(".scroll-fade-out").each(function(e){var a=$(this);$(window).on("scroll",function(){var e=$(this).scrollTop(),t=1-(e-a.outerHeight()/2+300)/300;a.css({opacity:t}),"1"<t||0==e?a.css({opacity:1}):t<"0"&&a.css({opacity:0})})}),"undefined"!=typeof Swiper)new Swiper(".swiper-about",{slidesPerView:"auto",grabCursor:!0,navigation:{nextEl:".ap-about__controls-next",prevEl:".ap-about__controls-prev"}})}(),function(){function s(e){if(e){e.author_links=JSON.parse(e.author_links),e.author_image||(e.author_image="default.jpg");var t=$("#about-author-template").html();Mustache.parse(t);var a=Mustache.render(t,e);$("#about-author-holder").html(a),$(".ap-author-details").removeClass("loading"),$("body").hasClass("ap-admin")&&$(".ap-author-details").find(".about-author__support").hide()}else $(".ap-author-details").find(".ap-loading-circle").addClass("error")}$("body").on("click",".toggle-author-details",function(e){e.preventDefault();var t=$(this).attr("data-author");$(".ap-author-details").toggleClass("about-author-open");var o=setTimeout(function(){$(".ap-author-details").addClass("loading")},500);if($("body").hasClass("ap-admin")&&$("body").toggleClass("overflow-hidden"),$(".ap-author-details").hasClass("about-author-open")){$(".ap-author-details").find(".ap-loading-circle").removeClass("error");var a=null;sessionStorage.getItem("author_data_"+t)&&!$(".toggle-author-details").hasClass("no-cache")?(a=JSON.parse(sessionStorage.getItem("author_data_"+t)),clearTimeout(o),s(a)):$.ajax({url:"/ajax/getAuthorBasicInfoById",type:"POST",data:{id:t},success:function(e){(e=JSON.parse(e))&&"undefined"!=typeof Storage&&sessionStorage.setItem("author_data_"+t,JSON.stringify(e)),clearTimeout(o),s(e)},error:function(e,t,a){clearTimeout(o),$(".ap-author-details").find(".ap-loading-circle").addClass("error")}})}else $("#about-author-holder").html(""),$(".ap-author-details").removeClass("loading"),$(".ap-author-details").find(".ap-loading-circle").removeClass("error")})}(),function(){function t(){if($(".ap-authors-list").hasClass("ap-authors-list-open"))window.history.replaceState({},document.title,"/");else{var e=Math.floor(window.innerWidth/300);$(".ap-authors-list").addClass("loading"),$("#authors-list-content").css({"column-count":e}),window.location.hash="AuthorsList"}$(".ap-authors-list").toggleClass("ap-authors-list-open"),$("body").toggleClass("overflow-hidden"),$("#authors-list-content").children().length?$(".ap-authors-list").removeClass("loading"):sessionStorage.getItem("authors_list")?(data=JSON.parse(sessionStorage.getItem("authors_list")),a(data)):$.get("ajax/getAuthorsNameList",function(e){(e=JSON.parse(e))&&"undefined"!=typeof Storage&&sessionStorage.setItem("authors_list",JSON.stringify(e)),a(e)})}function a(e){$.each(e,function(e,t){var a=$(".ap-authors-list").find("template").html(),o=Mustache.render(a,t);Mustache.parse(a),$("#authors-list-content").append(o)}),$(".ap-authors-list").removeClass("loading")}"#AuthorsList"==window.location.hash&&t(),$("body").on("click",".toggle-authors-list",function(e){e.preventDefault(),t()})}(),function(){var o=$(".ap-book-details");var t=window.location.hash.replace("#","");if(t&&"authorsList"!=t){function a(e){e?("1"!=(e=e[0]).author.author_options.allow_public_emails&&delete e.author.author_email,s(e)):window.history.replaceState({},document.title,"/")}sessionStorage.getItem("book_"+t)?a(JSON.parse(sessionStorage.getItem("book_"+t))):$.get("ajax/getBookByAsbn/"+t,function(e){sessionStorage.setItem("book_"+t,e),a(JSON.parse(e))})}function s(e){"string"==typeof e.files&&(e.files=JSON.parse(e.files)),"string"==typeof e.author.author_links&&(e.author.author_links=JSON.parse(e.author.author_links)),"string"==typeof e.author.author_options&&(e.author.author_options=JSON.parse(e.author.author_options)),"1"!=e.author.author_options.allow_public_emails&&delete e.author.author_email;var t=$("#ap-book-details-template").html();Mustache.parse(t);var a=Mustache.render(t,e);$.when($("#ap-book-details-template-wrapper").html(a)).then(function(){o.removeClass("cover-expand"),o.addClass("active"),$("body").addClass("overflow-hidden"),$(".info-side__review-roll").html().length<700&&$(".info-side__review").addClass("expanded"),window.innerWidth<=800&&setTimeout(function(){$("#ap-book-details-template-wrapper").animate({scrollTop:$("#ap-book-details-template-wrapper")[0].scrollHeight/3.5},1e3)},425),window.location.hash=e.asbn,$.post("ajax/increaseBookView/"+e.asbn)})}function i(){$(".info-side__click-review").css({opacity:"0"})}$("body").on("click",".ap-book-see",function(e){if(e.preventDefault(),$(this).hasClass("ap-book-see-scoped")&&!e.target.classList.contains("ap-book-see"))return 0;s($(this).parents(".book").data("book"))}),$("body").on("click",".ap-book-close",function(e){setTimeout(function(){$(".info-side__review").removeClass("expanded")},600),o.removeClass("active"),$("body").removeClass("overflow-hidden"),window.history.replaceState({},document.title,"/")}),$("body").on("click",".expand-book-cover",function(){500<window.innerWidth&&$(".ap-book-details").toggleClass("cover-expand"),$(".ap-author-details").removeClass("about-author-open"),$(".ap-mail-to").removeClass("ap-mail-to-open"),$(".ap-support").removeClass("ap-support-open")}),$("body").on("mousemove",".info-side__review",function(e){if(768<window.innerWidth)if($(".info-side__review").hasClass("expanded"))i();else{var t=e.offsetX+"px",a=e.offsetY+"px";$(".info-side__click-review").css({left:t,top:a,opacity:".8",position:"absolute"})}}),$("body").on("mouseleave",".info-side__review",function(){i()}),$("body").on("click",".info-side__review",function(e){window.getSelection().toString()||$(this).toggleClass("expanded"),i()}),$("body").on("click",".info-side__review-more",function(e){$(".info-side__review").toggleClass("expanded")})}(),function(){if(!$(".ap-books").length)return;a(),$("body").on("keyup","#search-books-input",function(){var e=$(this).val();$(".ap-books").attr("data-search",e)}),$("body").on("click",".ap-books-controls li a.gender",function(e){if(e.preventDefault(),$(this).hasClass("active"))$(this.nodeName).each(function(){$(this).removeClass("active")}),$(this).removeClass("active"),$(".ap-books").attr("data-gender","");else{$(this.nodeName).each(function(){$(this).removeClass("active")}),$(this).addClass("active");var t=$(this).data("search");$(".ap-books").attr("data-gender",t)}o(),a(!0)}),$("body").on("submit","#form-search-books",function(e){e.preventDefault(),o(),a(!0)}),$("body").on("submit","#form-load-more-books",function(e){var t;e.preventDefault(),t=$(".ap-books").attr("data-page"),$(".ap-books").attr("data-page",Number(t)+1),a()}),$("body").on("click",".cover-flip",function(e){window.getSelection().toString()||"BUTTON"==$(e.target)[0].tagName||"SPAN"==$(e.target)[0].tagName||"I"==$(e.target)[0].tagName||"A"==$(e.target)[0].tagName||"B"==$(e.target)[0].tagName||$(this).parents(".book__content").toggleClass("flipped")}),$("body").on("click",".book-flip",function(e){$(this).parents(".book__content").toggleClass("flipped")}),$("body").on("click",".ap-books-clear-search",function(){o(),r(),i(),$("#form-load-more-books").show(),$("#search-books-input").val(""),$(".ap-books").attr("data-search",""),$(".ap-books").attr("data-gender",""),$(".ap-books-controls li a.gender").each(function(){$(this).removeClass("active")}),a(!0)});var s=$("#book-template").html();function a(t){var e=$(".ap-books").attr("data-gender"),a=$(".ap-books").attr("data-search"),o=$(".ap-books").attr("data-page");1==t&&$("#books-results-container").html(""),r(),$(".ap-search-field").addClass("disabled"),$(".ap-books-controls").addClass("disabled"),$(".books-load-more").addClass("loading"),$.ajax({url:"ajax/getBooks",type:"GET",data:{gender:e,search:a,page:o},success:function(e){0<(e=JSON.parse(e)).books.length?$.each(e.books,function(e,t){var a,o;t.truncDescription=t.description.substr(0,260)+"...",t.files=JSON.parse(t.files),t.author.author_options=JSON.parse(t.author.author_options),t.stringfyed=JSON.stringify(t),a=t,o=Mustache.render(s,a),$("#books-results-container").append(o)}):t&&function(){$(".ap-books").attr("data-search").length&&$(".search-term").html(" para "+$(".ap-books").attr("data-search"));$(".ap-books").attr("data-gender").length&&$(".gender-term").html(" no gênero "+$(".ap-books").attr("data-gender"));$(".ap-books-empty-warning").removeClass("hidden")}(),i(),e.pages.books.nextPage?$("#form-load-more-books").show():$("#form-load-more-books").hide()}})}function o(){$(".ap-books").attr("data-page","1")}function i(){$(".ap-search-field").removeClass("disabled"),$(".ap-books-controls").removeClass("disabled"),$(".books-load-more").removeClass("loading")}function r(){$(".ap-books-empty-warning").addClass("hidden")}Mustache.parse(s)}(),$("body").on("click",".toggle-contact",function(e){e.preventDefault(),$(".ap-contact").toggleClass("ap-contact-open")}),$("#ap-contact-form").on("submit",function(e){e.preventDefault(),$form=$(this),url=$form.attr("action"),data=$form.serialize(),$form.addClass("loading"),$.post(url,data,function(e){e=JSON.parse(e),$form.removeClass("loading"),$form.find("p.response").fadeIn("slow").html(e.message),$form[0].reset(),setTimeout(function(){$form.find("p.response").fadeOut("slow").html("")},3e3)})}),function(){var a;$("body").ready(function(){setTimeout(function(){var e;e=window.location.hash,0<$(e).length&&$("html, body").animate({scrollTop:$(e).offset().top-120},1e3)},500)}),768<=window.innerWidth&&($(".info-hero__content").on("mousemove",function(e){var t=$(this).offset(),a=100*(e.pageX-t.left)/$("body").width();$(".clipfollow").css({"clip-path":"polygon("+a+"% 0, 100% 0, 100% 100%, "+a+"% 100%)"})}),$(".info-hero__content").on("mouseleave",function(e){$(".clipfollow").css({"clip-path":"polygon(30% 0, 100% 0, 100% 100%, 30% 100%)"})})),a=600,$(".read-more").each(function(){var e=$(this).text(),t=e.slice(0,a)+"<span class='ellipsis'>... <br/><br/></span><a href='#' class='more'><i class='fa fa-plus-circle' aria-hidden='true'></i> <b>Ler Mais</b></a><span style='display:none'>"+e.slice(a,e.length)+"<br/><br/><a href='#' class='less'><i class='fa fa-minus-circle' aria-hidden='true'></i> <b>Recolher</b></a></span>";e.length<a||$(this).html(t)}),$(".more").click(function(e){e.preventDefault(),$(this).hide().prev().hide(),$(this).next().show()}),$(".less").click(function(e){e.preventDefault(),$(this).parent().hide().prev().show().prev().show()})}(),768<=window.innerWidth&&($(".join-hero__content").on("mousemove",function(e){var t=$(this).offset(),a=100*(e.pageX-t.left)/$("body").width();$(".clipfollow").css({"clip-path":"polygon("+a+"% 0, 100% 0, 100% 100%, "+a+"% 100%)"})}),$(".join-hero__content").on("mouseleave",function(e){$(".clipfollow").css({"clip-path":"polygon(30% 0, 100% 0, 100% 100%, 30% 100%)"})})),$("#ap-join-form").on("submit",function(e){if(e.preventDefault(),$form=$(this),$form.find(".pass").val()!=$form.find(".pass-confirm").val())return $form.find("p.response").fadeIn("slow").html("As senhas não correspondem"),void setTimeout(function(){$form.find("p.response").fadeOut("slow").html("")},6e3);url=$form.attr("action"),data=$form.serialize(),$form.addClass("loading"),$.post(url,data,function(e){e=JSON.parse(e),$form.removeClass("loading"),$form.find("p.response").fadeIn("slow").html(e.message),setTimeout(function(){$form.find("p.response").fadeOut("slow").html("")},6e3),e.status&&$form[0].reset()})}),function(){function o(){$("#mail-to-author input:not([type=hidden]), #mail-to-author textarea:not([type=hidden])").val("")}$("body").on("click",".toggle-mail-to",function(e){e.preventDefault();var t=$(this).attr("data-author-id"),a=$(this).attr("data-book-name");$(".ap-mail-to").find("#author-id").val(t),$(".ap-mail-to").find("#book-name").val(a),o(),$(".ap-mail-to").toggleClass("ap-mail-to-open")}),$(".ap-mail-to form").on("submit",function(e){e.preventDefault(),$form=$(this),url=$form.attr("action"),data=$form.serialize(),$form.addClass("loading"),$.post(url,data,function(e){e=JSON.parse(e),$form.removeClass("loading"),$form.find("p.response").fadeIn("slow").html(e.message),o(),setTimeout(function(){$form.find("p.response").fadeOut("slow").html("")},3e3)})})}(),function(){var t=$(".ap-navbar"),a=$(window),o=$(window).scrollTop();t.hasClass("auto-hide")&&a.on("scroll",function(){var e=a.scrollTop();(o+400<e||e<o-400)&&(t.toggleClass("hidden",o<e),o=e)}),$(".ap-navbar-hamburger").click(function(e){$(this).toggleClass("close-shape")})}(),function(){var a=$(".newsletter-result-message").html();function o(){$(".newsletter-subscribe-form").removeClass("loading"),$(".newsletter-subscribe-form").removeAttr("disabled",!0)}function s(){$(".newsletter-subscribe-form")[0].reset()}$("body").on("submit",".newsletter-subscribe-form",function(e){e.preventDefault();var t=$(this).find("input.newsletter-input").val();data=$(this).serialize(),t.trim()&&($(".newsletter-subscribe-form").find("input").blur(),$(".newsletter-subscribe-form").attr("disabled",!0),$(".newsletter-subscribe-form").addClass("loading"),$.post("ajax/subscribe",data,function(e){var t;e=JSON.parse(e),o(),t=e.message,s(),$(".newsletter-result-message").hide().html(t).fadeIn("slow"),setTimeout(function(){$(".newsletter-result-message").hide().html(a).fadeIn("slow"),s(),o()},5e3)}))})}(),$sidebar=$(".ap-sidebar"),$hamburger=$(".ap-navbar-hamburger"),$(".ap-sidebar-toggle").click(function(){$sidebar.toggleClass("active").focus(),$("body").toggleClass("sidebar-open")}),$sidebar.on("mouseleave",function(){1!=$(".ap-sidebar:hover, .ap-sidebar-toggle:hover").length&&$sidebar.hasClass("active")&&!$sidebar.find(".tile.active").length&&$hamburger.trigger("click")}),$(".ap-opening, .ap-wrapper, .ap-content, .ap-navbar").click(function(){$sidebar.hasClass("active")&&$hamburger.trigger("click")}),$("[data-tile]").on("click",function(e){e.preventDefault(),"#best-sellers"==$(this).data("tile")&&($("#best-sellers").addClass("loading"),$.get("/ajax/getBestSellers",function(e){var e=JSON.parse(e),o=$("#best-sellers").find("template").html();$("#best-sellers").find(".bests-list").html().length||$.each(e.books,function(e,t){t.truncDescription=t.description.substr(0,260)+"...",t.files=JSON.parse(t.files),t.author.author_options=JSON.parse(t.author.author_options),t.stringfyed=JSON.stringify(t),t.number=e+1;var a=Mustache.render(o,t);$("#best-sellers").find(".bests-list").append(a)}),$("#best-sellers").removeClass("loading")})),$($(this).data("tile")).toggleClass("active"),$sidebar.toggleClass("put-behind")}),$("body").on("click",".toggle-support",function(e){e.preventDefault();var t=$(this).attr("data-author-pg");$(".ap-donation-link").attr("href","https://pagseguro.uol.com.br/checkout/v2/donation.html?currency='BRL'&receiverEmail="+t),$(".ap-support").toggleClass("ap-support-open")});